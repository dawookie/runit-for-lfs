====================================================================================

Installation of Runit

====================================================================================

First download a copy of Runit from the Runit homepage here:

  http://smarden.org/runit/runit-2.1.2.tar.gz

Or use git to checkout a copy:

  git clone http://smarden.org/git/runit.git
  
Unpack the sources as you would any other source package and the change directory to
the Runit directory in the package as such:

  cd admin/runit-2.1.2

Now we'll build the package using this command:

  package/compile
  
This will build all the relevant software and manpages. Now while in the runit-2.1.1
base directory, we'll install Runit into the system:

  cd command
  install runit runit-init /sbin
  install runsvdir runsv chpst svlogd sv /usr/bin
  install runsvchdir utmpset /usr/sbin
  cp ../man/* /usr/share/man/man8
  ln -s /sbin/runit-init /sbin/init
  mkdir -pv /etc/sv
  mkdir -pv /etc/runit/runsvdir/single
  mkdir -pv /etc/runit/runsvdir/multi
  
This should install all files to the proper locations.

Now you'll want to install the service files. Navigate to /setup, and run the
utilities inside as such:

./build.sh - This will build the sysvinit and service applets for Runit to work
             from to handle shutdowns, reboots, etc.
./install.sh - This will install all the appropriate files for runit-for-lfs
               to their correct directories and locations.
./remove.sh - This utility will remove all the runit-for-lfs files from the
              system. This utility is also best ran when performing an upgrade
              prior to reinstallation.
  
Several binaries and scripts critical to the system controls will be installed:

  pause    - /usr/bin - A simple service state holding program.
  shutdown - /sbin    - A script that functions to shutdown the system.
  halt     - /sbin    - A program to mimic the functions of sysvinit's halt.
  reboot   - /sbin    - A symlink to halt that issues restart command.
  poweroff - /sbin    - A symlink to halt that powers down the system.
  suspend  - /sbin    - A small program to suspend the system state.

Along with these, several key components of the LFS networking scripts will be
installed as well.

To use scripts. You must first make the script executable such as:

  chmod +x /etc/sv/agetty-tty1/*
  
Note: Some services have a log run file as well so you would need to issue a
      command for chmod +x on the run file of the log directory.
      
Now to link a service into the execution path, issue something like this:

If you are in (chroot):

  ln -sv /etc/sv/agetty-tty1 /etc/runit/runsvdir/multi
  
This will start a getty in multi-user mode. For any other services you'll issue
a similar command in chroot.

You'll need to at least assign multi the following:

agetty-tty1~6

Service agetty-ttyS0 must go into the /etc/runit/runsvdir/single prior to boot.

================================================================================

Description of application files:

runit - It performs the system?s booting, running, and shutdown in three stages.

runit-init - The first process the kernel starts.

sv - Controls and manages services monitored by runsv.

runsvdir - Starts and monitors a collection of runsv processes.

runsvchdir - Changes services directory of runsvdir.

runsv - Starts and monitors a service and optionally an appendant log service.

svlogd - Runit's service logging daemon.

chpst - Runs a program with a changed process state.

utmpset - Logout a line from utmp and wtmp file.

================================================================================
  
